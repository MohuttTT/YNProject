<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>

  <title>구내식당</title>
  <meta content="" name="description"/>
  <meta content="" name="keywords"/>

  <!-- link 안에는 th:href 사용! -->
  <!-- Favicons -->
  <link th:href="@{/assets/img/favicon.png}" rel="icon"/>
  <link th:href="@{/assets/img/apple-touch-icon.png}" rel="apple-touch-icon"/>

  <!-- 폰트 설정  -->
  <link th:href="@{https://fonts.gstatic.com}" rel="preconnect"/>
  <link
          href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
          rel="stylesheet"
  />

  <!-- Vendor CSS Files -->
  <link th:href="@{/assets/vendor/bootstrap/css/bootstrap.min.css}" rel="stylesheet"/>
  <link th:href="@{/assets/vendor/bootstrap-icons/bootstrap-icons.css}" rel="stylesheet"/>
  <link th:href="@{/assets/vendor/boxicons/css/boxicons.min.css}" rel="stylesheet"/>
  <link th:href="@{/assets/vendor/quill/quill.snow.css}" rel="stylesheet"/>
  <link th:href="@{/assets/vendor/quill/quill.bubble.css}" rel="stylesheet"/>
  <link th:href="@{/assets/vendor/remixicon/remixicon.css}" rel="stylesheet"/>
  <link th:href="@{/assets/vendor/simple-datatables/style.css}" rel="stylesheet"/>
  <link th:href="@{/node_modules/froala-editor/css/froala_editor.pkgd.min.css}" rel="stylesheet" type="text/css"/>

  <!-- Template Main CSS File -->
  <link th:href="@{/assets/css/style.css}" rel="stylesheet"/>
  <link th:href="@{/assets/css/wemaked.css}" rel="stylesheet"/>
  <script src="/assets/js/theme.js"></script>

  <!-- =======================================================
* Template Name: NiceAdmin
* Template URL: https://bootstrapmade.com/nice-admin-bootstrap-admin-html-template/
* Updated: Apr 20 2024 with Bootstrap v5.3.3
* Author: BootstrapMade.com
* License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>
<!-- ======= Header ======= -->
<header class="header fixed-top d-flex align-items-center" id="header">
  <div class="d-flex align-items-center justify-content-between">
    <a class="logo d-flex align-items-center" href="/">
      <img alt="" src="/assets/img/logo.png"/>
      <span class="d-none d-lg-block">CHAIN</span>
    </a>
    <i class="bi bi-list toggle-sidebar-btn"></i>
  </div>
  <!-- 로고 끝 -->

  <!-- <div class="search-bar">
    <form class="search-form d-flex align-items-center" method="POST" action="#">
      <input type="text" name="query" placeholder="Search" title="Enter search keyword" />
      <button type="submit" title="Search"><i class="bi bi-search"></i></button>
    </form>
  </div> -->
  <!-- 검색바 끝 -->

  <nav class="header-nav ms-auto">
    <ul class="d-flex align-items-center">
      <!-- <li class="nav-item d-block d-lg-none">
        <a class="nav-link nav-icon search-bar-toggle" href="#">
          <i class="bi bi-search"></i>
        </a>
      </li> -->
      <!-- 검색 아이콘 끝 -->

      <li class="nav-item dropdown" id="commuteIcon">
        <div class="from-check form-switch me-3">
          <input class="form-check-input" id="flexSwitchCheckDefault" type="checkbox">
        </div>
      </li>
      <!-- 출퇴근 아이콘 끝 -->

      <th:block th:include="fragments/notifications :: notifications"></th:block>
      <!-- 알림 전체 끝 -->

      <li class="nav-item dropdown">
        <a class="nav-link nav-icon" href="/user/setting">
          <i class="bi bi-gear"></i>
        </a>
        <!-- 환경설정 아이콘 끝 -->
      </li>
      <!-- 환경설정 전체 끝 -->


      <th:block th:include="fragments/profile :: profile"></th:block>
      <!-- 프로필 전체 끝 -->
    </ul>
  </nav>
  <!-- 상단바 끝 -->
</header>

<!-- Header 끝 -->

<th:block th:include="fragments/commute :: commute"></th:block>
<!-- 출퇴근 Modal 끝 -->

<!-- ======= Sidebar ======= -->
<th:block th:include="fragments/sidebar :: sidebar"></th:block>
<!-- Sidebar 전체 끝 -->
<!----------------------------------------------------------------------고정 사이드바 ------------------------------------------------------------------------>
<main id="main" class="main">
  <div class="pagetitle">
    <h1>구내식당</h1>
    <nav>
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Home</a></li>
        <li class="breadcrumb-item active">구내식당</li>
      </ol>
    </nav>
  </div>
  <!------------------------------------------------------------------페이지 별 타이틀 ------------------------------------------------------------------------>

  <div class="row gy-4 mb-3">
    <div class="col-xl-6">
      <button type="button" class="btn btn-primary uploadFileBtn">식당표 업로드</button>
      <button type="submit" class="btn btn-primary submitBtn">저장</button>
    </div>
  </div>
  <!------------------------------------------------------------------위젯 1---------------------------------------------------------------------->

  <section class="section ">
    <div class="row">
      <!-- 첨부 파일 사진을 보여줄 부분 -->
      <div class="col-lg-12">
        <div class="card">
          <div class="container-fluid d-flex uploadResult" style="flex-wrap: wrap;">
          </div>
        </div>
      </div>
    </div>
  </section>

  <p>사원번호 : <span th:text="${session.empNo}"></span></p>
</main>

<!-- --------------------------------------------첨부파일 추가를 위한 모달창 ---------------------------------------------->
<div class="modal uploadModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">사진추가</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="input-group mb-3">
          <input type="file" name="files" class="form-control" multiple>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary uploadBtn">업로드</button>
        <button type="button" class="btn btn-outline-dark closeUploadBtn" data-bs-dismiss="modal">취소</button>
      </div>
    </div>
  </div>
</div>

<!-- ======= Footer ======= -->
<th:block th:include="fragments/footer :: footer"></th:block>
<!-- Footer 끝 -->

<!-- Vendor JS Files -->
<script src="/assets/vendor/apexcharts/apexcharts.min.js"></script>
<script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="/assets/vendor/chart.js/chart.umd.js"></script>
<script src="/assets/vendor/echarts/echarts.min.js"></script>
<script src="/assets/vendor/quill/quill.js"></script>
<script src="/assets/vendor/simple-datatables/simple-datatables.js"></script>
<script src="/assets/vendor/tinymce/tinymce.min.js"></script>
<script src="/assets/vendor/php-email-form/validate.js"></script>
<script type="text/javascript" src="/node_modules/froala-editor/js/froala_editor.pkgd.min.js"></script>
<script type="text/javascript" src="/node_modules/froala-editor/js/languages/ko.js"></script>

<!-- 메신저 관련 라이브러리 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.1.4/sockjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<!-- Template Main JS File -->
<script src="/assets/js/main.js"></script>
<script src="/assets/js/wemaked.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!--이미지 업로드-->
<script>
  //업로드 모달
  /* 모달 초기화 및 열기 */
  const uploadModal = new bootstrap.Modal(document.querySelector(".uploadModal"));
  /* 버튼 클릭 이벤트 리스너 추가 -- 버튼 클릭하면 모달 창 열리도록 */
  document.querySelector(".uploadFileBtn").addEventListener("click", function (e) {
    e.stopPropagation();
    e.preventDefault();
    uploadModal.show();
  }, false);

  // 업로드 버튼 클릭 시 파일 업로드 처리 및 업로드 결과 표시
  document.querySelector('.uploadBtn').addEventListener('click', function() {
    const input = document.querySelector('input[name="files"]');
    const files = input.files;
    const uploadResult = document.querySelector('.uploadResult');

    for (const file of files) {
      const reader = new FileReader();
      reader.onload = function(e) {
        const imageUrl = e.target.result;

        // 이미지 썸네일 생성
        const div = document.createElement('div');
        div.classList.add('image-thumbnail');
        div.innerHTML = `
          <img src="${imageUrl}" alt="${file.name}" class="img-thumbnail">
          <button class="btn btn-danger btn-sm delete-btn">삭제</button>
        `;
        uploadResult.appendChild(div);

        // 삭제 버튼 이벤트 리스너 추가
        div.querySelector('.delete-btn').addEventListener('click', function() {
          uploadResult.removeChild(div);
        });
      };
      reader.readAsDataURL(file);
    }

    // 모달 닫기
    uploadModal.hide();
  });

  // 취소 버튼 클릭 시 모달 닫기
  document.querySelector('.closeUploadBtn').addEventListener('click', function() {
    uploadModal.hide();
  });
</script>
</body>
</html>
